<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Git 常見問題 | Louis&#39;s blog</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.58.3" />
    
    
      <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
    

    
    
      <link href="/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    
      <link rel="stylesheet" href="/dist/css/custom.css">
    

    
      <script src="/dist/js/custom.js"></script>
    

    
      
<link rel="shortcut icon" href="/images/icon.png" type="image/x-icon" />


    

    

    <link rel="stylesheet" href="/prism.css"/>
    <script src="/prism.js"></script>

    <script data-ad-client="ca-pub-3625283913171459" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

    <meta property="og:title" content="Git 常見問題" />
<meta property="og:description" content="你遇到這樣的問題了嗎？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://szlforgithub.github.io/post/gitproblem/" />
<meta property="article:published_time" content="2020-06-14T20:47:43+08:00" />
<meta property="article:modified_time" content="2020-06-14T20:47:43+08:00" />
<meta itemprop="name" content="Git 常見問題">
<meta itemprop="description" content="你遇到這樣的問題了嗎？">


<meta itemprop="datePublished" content="2020-06-14T20:47:43&#43;08:00" />
<meta itemprop="dateModified" content="2020-06-14T20:47:43&#43;08:00" />
<meta itemprop="wordCount" content="1974">



<meta itemprop="keywords" content="學習筆記,版本控制," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Git 常見問題"/>
<meta name="twitter:description" content="你遇到這樣的問題了嗎？"/>

      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-169325906-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
	
  </head>

  <body class="ma0 sans-serif production">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://szlforgithub.github.io/images/git.png');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib" style="font-family: oswald; font-weight:bold;">
      
        Louis&#39;s blog
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/post/" title="Articles page">
              Articles
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
        </ul>
      
      















    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Git 常見問題</h1>
          
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              你遇到這樣的問題了嗎？
            </h2>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-format="fluid"
           data-ad-layout-key="-gw-3+1f-3d+2z"
           data-ad-client="ca-pub-3625283913171459"
           data-ad-slot="6307250913"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      

      

      <h1 class="f1 athelas mt3 mb1">Git 常見問題</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-06-14T20:47:43&#43;08:00">June 14, 2020</time>

      
      
        <span class="f6 mv4 dib tracked"> - 4 minutes read</span>
        <span class="f6 mv4 dib tracked"> - 1974 words</span>
      
    </header>
    <div class="nested-copy-line-height lh-copy sans-serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l">

<h2 id="正確的使用姿勢">正確的使用姿勢？</h2>

<p><code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git init</code> 或是 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git clone</code> 之後，你可能會手癢先 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git status</code> 看一下，你會看到一個乾淨的目錄，然後開始編寫程式碼，一邊寫一邊 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git diff</code> 看自己到底改了哪些東西，改了一個段落在 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git add</code> 之前或許會 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git branch</code> 確定一下自己在哪個分支，有錯的話趕快 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git checkout branchName</code> 到正確的分支，接著 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git add</code> 把修改存到暫存區，<code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git status</code> 看一下是不是正確的狀態，然後 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git commit -m "This is my new git description"</code>，最後 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git push</code> 。</p>

<hr />

<h2 id="這行誰寫的">這行誰寫的！</h2>

<p>一覺醒來發現網站掛了，怎麼多了這一行扣！<code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git blame index.php</code> 可以看到 index.php 裡每一行的作者是誰。</p>

<hr />

<h2 id="這個-commit-到底修改了啥">這個 commit 到底修改了啥？</h2>

<p>先 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git log</code> 找到那次修改的 commit ID，你或許會用到</p>

<pre><code class="language-git=">git log --author=&quot;Louis.Su&quot;
</code></pre>

<p>來篩選出 commit 作者，或者是</p>

<pre><code class="language-git=">git log --grep=&quot;Hey&quot;
</code></pre>

<p>來找到 description 裡面包含 Hey 的 commit，又或者</p>

<pre><code class="language-git=">git log -S &quot;functionA&quot;
</code></pre>

<p>來找到上傳檔案有包含 functionA 的 commit。
最後<code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git show commitID</code>，就可以看到修改記錄了。</p>

<hr />

<h2 id="我想修改剛剛的-commit">我想修改剛剛的 commit</h2>

<p>想修改最後一次的 commit，可以輸入</p>

<pre><code class="language-git=">git commit --amend -m &quot;This is right description&quot;
</code></pre>

<p>對人類來說只是修改 commit 的訊息，但對 git 來說，這其實是一個全新的 commit 了，可以從 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git log --oneline</code> 中看到 commit 的 SHA-1 值是不同的。</p>

<hr />

<h2 id="我可以修改更之前的-commit-嗎">我可以修改更之前的 commit 嗎？</h2>

<p>這通常發生在自己開的 branch 裡 commit 雜亂無章的情況，想做好修剪之後再 push。盡量不要在已經 push 到中央伺服器的 commit 進行這種操作，除非你和你的團隊非常清楚自己在做什麼，這會造成協作者的混亂，因為同樣的程式碼有不同的版本，而且它會改變歷史 (這也是 rebase 屬於危險指令的原因)。</p>

<p>Git 本身並沒有修改歷史的工具。但可以使用 rebase 來做到對過去 commit 的修改。
<br></p>

<pre><code class="language-git=">git rebase -i
</code></pre>

<p>可以開啟對話模式，要給他一個參數，這個參數可以是 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git rebase -i HEAD~3</code> 這樣從當前分支往前算的形式，也可以是 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git rebase -i 6ee9b6b</code> 這樣的 SHA-1 值，意思是「從這一個 commit 往後算到現在位子的所有 commit 」。</p>

<p>之後會出現像這樣的列表：</p>

<pre><code>pick f7f3f6d fix some bugs
pick 310154e add some files
pick a5f4a0d feat: complete a feature

# Rebase 710f0f8..a5f4a0d onto 710f0f8
#
# Commands:
#  p, pick = use commit
#  r, reword = use commit, but edit the commit message
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#  f, fixup = like &quot;squash&quot;, but discard this commit's log message
#  x, exec = run command (the rest of the line) using shell
#
# These lines can be re-ordered; they are executed from top to bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
# Note that empty commits are commented out
</code></pre>

<p>前幾行 pick 的意思是保留 commit 不做修改，如果你是想修改 commit message 的話，把 pick 改成 reword ：</p>

<pre><code>reword f7f3f6d fix some bugs
pick 310154e add some files
pick a5f4a0d feat: complete a feature
</code></pre>

<p>表示我要修改這個 commit ，存檔離開後會再跳出另一個編輯器畫面，將 fix some bugs 改成你想要的 commit message 之後存檔離開， git 就會處理完剩下的事情。</p>

<p>如同上文中對 rebase 的描述，聰明如你肯定也猜到了，是的，這個 commit 同樣是全新的一個 commit ，而在這裡要注意的是，因為修改了過去的歷史，在這個 commit 之後的所有 commit 因為歷史的改變，所以整串 commit 都會變成新的 commit 。</p>

<p>因為過去被改變了，所以未來也會產生相應的變化，<del>這就是平行時空的概念</del>。</p>

<p>而 edit 和 reword 不同的地方在於： edit 同時還能修改 commit 內容，他會在 rebase 的過程中暫停等待你修改，所以當你：</p>

<pre><code>edit f7f3f6d fix some bugs
pick 310154e add some files
pick a5f4a0d feat: complete a feature
</code></pre>

<p>存檔離開後， git 會 checkout 到你想修改的 commit ，當你進行完你想做的修改之後， <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git add [你有修改的檔案]</code> ，之後再 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git commit --amend </code> 修改 commit message ，最後再輸入 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git rebase --continue</code> 將 rebase 完成。</p>

<p>另外的 squash 和 fixup 則是用來合併 commit，不同的地方是當你用 squash 要合併時，會把多個要合併的 commit message 放進編輯器裡面讓你修改最後合併的 commit message ；而 fixup 則是把這個 commit 合併到上一個 commit 中，並直接捨棄這個 commit message。</p>

<hr />

<h2 id="挫賽-我可以重來嗎">挫賽！我可以重來嗎？</h2>

<p>git 的強大之處在於他大部分的指令都是可逆的，但它同樣也是危險的，因為並不是所有操作都可逆，一不小心就會搞得整個環境亂七八糟，在實戰時執行指令前都要謹慎思考，清楚知道自己在幹嘛，強烈建議可以搭配 Github 開一個自己來玩玩看。</p>

<p>這一 part 會先介紹如何反悔，再說明 reset 這個指令的意義，建議看完再操作。</p>

<h3 id="如何將暫存區的檔案移出">如何將暫存區的檔案移出</h3>

<p>這樣的場景會出現在你修改了兩個檔案，想要分別提交，但你手速太快不小心打了 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git add -A</code> 全部加到暫存區了。</p>

<pre><code class="language-git=">git reset HEAD &lt;filename&gt;
</code></pre>

<h3 id="如何將剛剛的-commit-拆回來">如何將剛剛的 commit 拆回來</h3>

<p>這樣的場景則出現在後悔剛剛那個 commit 的內容，想拆回來重做，你可以先下 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git log</code> 或 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">git log --oneline</code> 來看到 SHA-1 值，然後：</p>

<pre><code class="language-git=">git reset 6ee9b6b
</code></pre>

<p>也可以用相對的方式：</p>

<pre><code class="language-git=">git reset HEAD^
</code></pre>

<h3 id="哇塞我整個專案都玩壞了-怎麼回復成原本的樣子">哇塞我整個專案都玩壞了，怎麼回復成原本的樣子</h3>

<pre><code class="language-git=">git reset --hard HEAD~2
</code></pre>

<p>這行指令的意思是最後的兩個版本(HEAD、HEAD^)我都不要了，我也不想讓人看見他，專案會直接回到 HEAD^^ 的狀態，所以在下指令前請確保你的 HEAD、HEAD^ 都是不要的。</p>

<h3 id="我還想要-head-或-head-能回復嗎">我還想要 HEAD 或 HEAD^，能回復嗎？</h3>

<p>其實還是救的回來，先下：</p>

<pre><code class="language-git=">git reflog
</code></pre>

<p>reflog 裡面存的是「HEAD移動的紀錄」，你會看到你剛剛 reset 的紀錄，所以要取消 reset 的話，就要「reset 到 reset 前的那個 commit 」：</p>

<pre><code class="language-git=">git reset --hard &lt;commitID&gt;
</code></pre>

<p>講到這裡聰明的你一定已經隱約感覺到 reset 的意義了，在中文會比較接近「前往」。</p>

<p>而 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--hard</code> 是參數，有三種常見的： <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--mixed</code> 、 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--soft</code> 、 <code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--hard</code> ，這個參數決定的是「那些我不要的東西最後要去哪裡」
<code><code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--mixed`</code> 是預設，這個模式下的 reset commit 會把 commit 內容丟進工作目錄裡面
</code><code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--soft`</code> 則會把 commit 內容丟進暫存區
`<code style="font-size: 85%;background-color: rgba(0,0,0,.1);border-radius: 3px;">--hard`</code> 則是工作目錄和暫存區都不會留</p>

<p>所以前文說的「拆」 commit 其實並不準確，而是「回到」那個 commit 的狀態，不同參數則決定了路過的那幾個檔案將何去何從。</p>

<h2 id="參考資料">參考資料</h2>

<ol>
<li><a href="https://git-scm.com/book/zh-tw/v2">Git官方文件</a></li>
<li><a href="https://gitbook.tw/">為你自己學Git</a></li>
<li><a href="https://backlog.com/git-tutorial/tw/">連猴子都能懂的Git入門指南</a></li>
</ol>
<ul class="pa0">
  
   <li class="list">
     <a href="/tags/%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">學習筆記</a>
   </li>
  
   <li class="list">
     <a href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">版本控制</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      <div id="disqus_thread"></div>
<script>





(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://louissublog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">
    









<div class="toc">

    <div class="page-header"><strong>目錄</strong></div>

    <div id="page-scrollspy" class="toc-nav">

        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e6%ad%a3%e7%a2%ba%e7%9a%84%e4%bd%bf%e7%94%a8%e5%a7%bf%e5%8b%a2">
                            正確的使用姿勢？
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e9%80%99%e8%a1%8c%e8%aa%b0%e5%af%ab%e7%9a%84">
                            這行誰寫的！
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e9%80%99%e5%80%8b-commit-%e5%88%b0%e5%ba%95%e4%bf%ae%e6%94%b9%e4%ba%86%e5%95%a5">
                            這個 commit 到底修改了啥？
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e6%88%91%e6%83%b3%e4%bf%ae%e6%94%b9%e5%89%9b%e5%89%9b%e7%9a%84-commit">
                            我想修改剛剛的 commit
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e6%88%91%e5%8f%af%e4%bb%a5%e4%bf%ae%e6%94%b9%e6%9b%b4%e4%b9%8b%e5%89%8d%e7%9a%84-commit-%e5%97%8e">
                            我可以修改更之前的 commit 嗎？
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e6%8c%ab%e8%b3%bd-%e6%88%91%e5%8f%af%e4%bb%a5%e9%87%8d%e4%be%86%e5%97%8e">
                            挫賽！我可以重來嗎？
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e5%a6%82%e4%bd%95%e5%b0%87%e6%9a%ab%e5%ad%98%e5%8d%80%e7%9a%84%e6%aa%94%e6%a1%88%e7%a7%bb%e5%87%ba">
                            如何將暫存區的檔案移出
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e5%a6%82%e4%bd%95%e5%b0%87%e5%89%9b%e5%89%9b%e7%9a%84-commit-%e6%8b%86%e5%9b%9e%e4%be%86">
                            如何將剛剛的 commit 拆回來
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e5%93%87%e5%a1%9e%e6%88%91%e6%95%b4%e5%80%8b%e5%b0%88%e6%a1%88%e9%83%bd%e7%8e%a9%e5%a3%9e%e4%ba%86-%e6%80%8e%e9%ba%bc%e5%9b%9e%e5%be%a9%e6%88%90%e5%8e%9f%e6%9c%ac%e7%9a%84%e6%a8%a3%e5%ad%90">
                            哇塞我整個專案都玩壞了，怎麼回復成原本的樣子
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e6%88%91%e9%82%84%e6%83%b3%e8%a6%81-head-%e6%88%96-head-%e8%83%bd%e5%9b%9e%e5%be%a9%e5%97%8e">
                            我還想要 HEAD 或 HEAD^，能回復嗎？
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                    </ul>
                    
                
            
        
        
            
                
                
                    
                    <ul class="nav">
                    
                    <ul class="nav">
                    
                    
                        <li class="nav-item">
                            <a class="nav-link text-left" href="#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99">
                            參考資料
                            </a>
                        </li>
                    
                    
                    </ul>
                    
                    </ul>
                    
                
            
        

    </div>

</div>







  

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://szlforgithub.github.io/" >
    &copy;  Louis's blog 2020 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
